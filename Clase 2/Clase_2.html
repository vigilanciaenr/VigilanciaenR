<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Clase 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Clase_2_files/libs/clipboard/clipboard.min.js"></script>
<script src="Clase_2_files/libs/quarto-html/quarto.js"></script>
<script src="Clase_2_files/libs/quarto-html/popper.min.js"></script>
<script src="Clase_2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Clase_2_files/libs/quarto-html/anchor.min.js"></script>
<link href="Clase_2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Clase_2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Clase_2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Clase_2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Clase_2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<style>html{ scroll-behavior: smooth; }</style>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice de Contenidos</h2>
   
  <ul>
  <li><a href="#importación-datos" id="toc-importación-datos" class="nav-link active" data-scroll-target="#importación-datos"><strong>1.Importación datos</strong></a>
  <ul class="collapse">
  <li><a href="#datos-.xlsx" id="toc-datos-.xlsx" class="nav-link" data-scroll-target="#datos-.xlsx">1.1. Datos .xlsx</a></li>
  <li><a href="#datos-.csv" id="toc-datos-.csv" class="nav-link" data-scroll-target="#datos-.csv">1.2. Datos .csv</a></li>
  <li><a href="#google-sheet" id="toc-google-sheet" class="nav-link" data-scroll-target="#google-sheet">1.3. Google sheet</a></li>
  <li><a href="#herramienta-de-importación-de-datos-de-rstudio" id="toc-herramienta-de-importación-de-datos-de-rstudio" class="nav-link" data-scroll-target="#herramienta-de-importación-de-datos-de-rstudio">1.4. Herramienta de importación de datos de RStudio</a></li>
  </ul></li>
  <li><a href="#limpieza-de-datos" id="toc-limpieza-de-datos" class="nav-link" data-scroll-target="#limpieza-de-datos"><strong>2. Limpieza de Datos</strong></a>
  <ul class="collapse">
  <li><a href="#identificación-de-datos-faltantes" id="toc-identificación-de-datos-faltantes" class="nav-link" data-scroll-target="#identificación-de-datos-faltantes">2.1. Identificación de datos faltantes</a>
  <ul class="collapse">
  <li><a href="#archivo-.xlsx" id="toc-archivo-.xlsx" class="nav-link" data-scroll-target="#archivo-.xlsx">2.1.1. Archivo .xlsx</a></li>
  <li><a href="#archivo-sheet" id="toc-archivo-sheet" class="nav-link" data-scroll-target="#archivo-sheet">2.1.2. Archivo sheet</a></li>
  </ul></li>
  <li><a href="#convertir-variables-a-tipos-correctos" id="toc-convertir-variables-a-tipos-correctos" class="nav-link" data-scroll-target="#convertir-variables-a-tipos-correctos">2.2. Convertir variables a tipos correctos</a>
  <ul class="collapse">
  <li><a href="#fechas" id="toc-fechas" class="nav-link" data-scroll-target="#fechas">2.2.1. Fechas</a></li>
  <li><a href="#crear-semanas-epidemiológicas" id="toc-crear-semanas-epidemiológicas" class="nav-link" data-scroll-target="#crear-semanas-epidemiológicas">2.2.1.1 Crear semanas epidemiológicas</a></li>
  </ul></li>
  <li><a href="#guardar-el-dataframe" id="toc-guardar-el-dataframe" class="nav-link" data-scroll-target="#guardar-el-dataframe">Guardar el DataFrame</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Clase 2</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="importación-datos" class="level2">
<h2 class="anchored" data-anchor-id="importación-datos"><strong>1.Importación datos</strong></h2>
<section id="datos-.xlsx" class="level3">
<h3 class="anchored" data-anchor-id="datos-.xlsx">1.1. Datos .xlsx</h3>
<p>Primero veremos como importar datos de Excel. Esto se puede realizar de varias maneras pero aquí veremos la librería “readxl” para ello.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a> <span class="co"># Cargamos la librerías (si aún no las instalamos este es el momento de hacerlo)}</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span>(readr) </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">library</span> (readxl) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Lo que tenemos que hacer para importar esta hoja de cálculo a R como un marco de datos es pasar la ruta al archivo Excel al argumento de la <code>read_excel()</code> función.</p>
<p>Es impotante tambien poner el “<code>.xlsx</code>” que indica el formato del archivo en la ruta de acceso. Esta ruta se puede tomar como atajo apretando <strong>Shift + click</strong> derecho en el archivo deseado y seleccionar la opción “copiar como ruta de acceso”.</p>
<div id="my-div" style="background-color:  #FFFFCC; padding: 20px; border: 1px solid #ccc; border-radius: 5px">
<p>Mac y Linux usan barras diagonales en las rutas de archivo (&nbsp;<code>/</code>) de forma predeterminada. Windows usa barras diagonales inversas (&nbsp;<code>\</code>) en las rutas de archivo de forma predeterminada. Sin embargo, sin importar qué sistema operativo estemos usando, R solo toma las barras diagonales de esta manera /. Si estas <strong>usando Windows</strong> <strong>modificá por barra diagonal</strong> <strong>/ o en su defecto por doble barra diagonal</strong> &nbsp;<strong><code>\\</code></strong> <strong>.</strong></p>
</div>
<p>Es importante poner la ruta relativa y no la ruta del archivo completa si se va a compartir el código de R, y que la ruta relativa este en la carpeta del proyecto de R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C:/Users/flor/Desktop/cursor_2024/VigilanciaenR/Clase 2"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ruta de archivo relativa  </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>excel_dengue <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"reportes/Reporte dengue &amp; chiku marzo 2024.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Cuando los datos en las tablas de excel no se encuentran ordenados y limpios, es necesario además de importarlos utilizar las herramientas de la libreria <code>"readxl"</code> para poder editarlos según nuestra necesidad. Lo veremos a continuación</p>
<p><strong>En estos link que se dirigen al repositorio de Github se encuentran los dataset con los que trabajaremos</strong></p>
<p><a href="https://github.com/vigilanciaenr/VigilanciaenR/blob/main/Reporte%20dengue%20%26%20chiku%20marzo%202024.xlsx">Excel_dengue y chiku</a></p>
<p><a href="https://github.com/vigilanciaenr/VigilanciaenR/blob/main/Reporte%20infecciones%20respiratorias%20marzo%202024.xlsx">Excel IRA</a></p>
<p>Si queremos importar solo una hoja de nuestro data set tendríamos que escribir de esta manera. En el ejemplo solo tenemos la hoja de “Reporte” asi es que no lo utilizaremos. Este código es solo un ejemplo, no correrá ya que no es adecuado el nombre de ruta</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importar la primera hoja</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data &lt;- read_excel("ruta/a/tu/archivo.xlsx", sheet = 1)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Importar la segunda hoja</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># data &lt;- read_excel("ruta/a/tu/archivo.xlsx", sheet = 2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si no estamos seguros de que nombre tienen las hojas podemos comporbarlo de esta manera.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Listar todos los nombres de las hojas en el archivo</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># hojas &lt;- excel_sheets("reportes/Reporte dengue &amp; chiku marzo 2024.xlsx")</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># hojas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Existen varias formas de controlar qué celdas se leen. Incluso se puede especificar la hoja, si se proporciona un rango de celdas al estilo de Excel.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># se utiliza para limitar el número de filas que se importan del archivo Excel. En este caso, se importan solo las primeras 3 filas de la hoja activa del archivo.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(<span class="st">"reportes/Reporte dengue &amp; chiku marzo 2024.xlsx"</span>, <span class="at">n_max =</span><span class="dv">3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 21
  `Apellido Ciudadano` `Calle Domicilio` `Departamento Residencia` `Edad Actual`
  &lt;chr&gt;                &lt;chr&gt;             &lt;chr&gt;                             &lt;dbl&gt;
1 GARCIA GAVELLO       CEIBO             San Fernando                         38
2 SCAREL               VENDIMIADORES     Capital                              68
3 SEGOVIA              ISLAS MALVINAS    25 de Mayo                           19
# ℹ 17 more variables: `Fecha Nacimiento` &lt;dttm&gt;, `Localidad Residencia` &lt;chr&gt;,
#   `Información de contacto` &lt;chr&gt;, `Nombre Ciudadano` &lt;chr&gt;, `Nro Doc` &lt;dbl&gt;,
#   `Numero Domicilio` &lt;dbl&gt;, `Provincia Residencia` &lt;chr&gt;, `Sexo Legal` &lt;chr&gt;,
#   `Clasificación manual del caso` &lt;chr&gt;, `Establecimiento de Carga` &lt;chr&gt;,
#   Evento &lt;chr&gt;, `Fecha Apertura` &lt;dttm&gt;, `Fecha de inicio de síntomas` &lt;chr&gt;,
#   Determinación &lt;chr&gt;, Resultado &lt;chr&gt;, Técnica &lt;chr&gt;,
#   `Fecha de toma de muestra` &lt;dttm&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Especifica un rango de celdas en formato de referencia de Excel. En este caso, importará los datos del rango que va desde la celda C1 hasta la celda E4.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(<span class="st">"reportes/Reporte dengue &amp; chiku marzo 2024.xlsx"</span>, <span class="at">range =</span> <span class="st">"C1:E4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  `Departamento Residencia` `Edad Actual` `Fecha Nacimiento` 
  &lt;chr&gt;                             &lt;dbl&gt; &lt;dttm&gt;             
1 San Fernando                         38 1986-04-17 00:00:00
2 Capital                              68 1956-05-05 00:00:00
3 25 de Mayo                           19 2005-02-07 00:00:00</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Especifica un rango basado en las filas que deseas importar. En este caso, se importarán las filas 1 a 4 de la hoja activa.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(<span class="st">"reportes/Reporte dengue &amp; chiku marzo 2024.xlsx"</span>, <span class="at">range =</span> <span class="fu">cell_rows</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 21
  `Apellido Ciudadano` `Calle Domicilio` `Departamento Residencia` `Edad Actual`
  &lt;chr&gt;                &lt;chr&gt;             &lt;chr&gt;                             &lt;dbl&gt;
1 GARCIA GAVELLO       CEIBO             San Fernando                         38
2 SCAREL               VENDIMIADORES     Capital                              68
3 SEGOVIA              ISLAS MALVINAS    25 de Mayo                           19
# ℹ 17 more variables: `Fecha Nacimiento` &lt;dttm&gt;, `Localidad Residencia` &lt;chr&gt;,
#   `Información de contacto` &lt;chr&gt;, `Nombre Ciudadano` &lt;chr&gt;, `Nro Doc` &lt;dbl&gt;,
#   `Numero Domicilio` &lt;dbl&gt;, `Provincia Residencia` &lt;chr&gt;, `Sexo Legal` &lt;chr&gt;,
#   `Clasificación manual del caso` &lt;chr&gt;, `Establecimiento de Carga` &lt;chr&gt;,
#   Evento &lt;chr&gt;, `Fecha Apertura` &lt;dttm&gt;, `Fecha de inicio de síntomas` &lt;chr&gt;,
#   Determinación &lt;chr&gt;, Resultado &lt;chr&gt;, Técnica &lt;chr&gt;,
#   `Fecha de toma de muestra` &lt;dttm&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Rango basado en las columnas que deseas importar. En este caso, se importarán todas las filas de las columnas B a D</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"reportes/Reporte dengue &amp; chiku marzo 2024.xlsx"</span>, <span class="at">range =</span> <span class="fu">cell_cols</span>(<span class="st">"B:E"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Especifica un rango de celdas en una hoja específica dentro de un archivo Excel que contiene varias hojas. En este caso, se importarán las celdas desde B1 hasta D5 de la hoja llamada "mtcars".</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(<span class="st">"reportes/Reporte dengue &amp; chiku marzo 2024.xlsx"</span>, <span class="at">range =</span> <span class="st">"Reporte!B1:D5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  `Calle Domicilio` `Departamento Residencia` `Edad Actual`
  &lt;chr&gt;             &lt;chr&gt;                             &lt;dbl&gt;
1 CEIBO             San Fernando                         38
2 VENDIMIADORES     Capital                              68
3 ISLAS MALVINAS    25 de Mayo                           19
4 AV. ARRIBALZAGA   San Fernando                         33</code></pre>
</div>
</div>
<section id="visualización-de-caracteristicas-del-dataset" class="level4">
<h4 class="anchored" data-anchor-id="visualización-de-caracteristicas-del-dataset">Visualización de caracteristicas del dataset</h4>
<p>Aplicando algunas funciones tendremos un detalle de los dataset cargados</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estructura del Dataset</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">dim</span>(excel_dengue) <span class="co"># Número de Filas y Columnas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6481   21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">head</span>(excel_dengue) <span class="co">#Resumen de las Primeras Filas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 21
  `Apellido Ciudadano` `Calle Domicilio`    Departamento Residen…¹ `Edad Actual`
  &lt;chr&gt;                &lt;chr&gt;                &lt;chr&gt;                          &lt;dbl&gt;
1 GARCIA GAVELLO       CEIBO                San Fernando                      38
2 SCAREL               VENDIMIADORES        Capital                           68
3 SEGOVIA              ISLAS MALVINAS       25 de Mayo                        19
4 ABALOS               AV. ARRIBALZAGA      San Fernando                      33
5 PIRIZ                LOTE                 Mayor Luis J. Fontana             29
6 BORJA BALLON         PASAJE INGENIERO FO… San Fernando                      35
# ℹ abbreviated name: ¹​`Departamento Residencia`
# ℹ 17 more variables: `Fecha Nacimiento` &lt;dttm&gt;, `Localidad Residencia` &lt;chr&gt;,
#   `Información de contacto` &lt;chr&gt;, `Nombre Ciudadano` &lt;chr&gt;, `Nro Doc` &lt;dbl&gt;,
#   `Numero Domicilio` &lt;chr&gt;, `Provincia Residencia` &lt;chr&gt;, `Sexo Legal` &lt;chr&gt;,
#   `Clasificación manual del caso` &lt;chr&gt;, `Establecimiento de Carga` &lt;chr&gt;,
#   Evento &lt;chr&gt;, `Fecha Apertura` &lt;dttm&gt;, `Fecha de inicio de síntomas` &lt;chr&gt;,
#   Determinación &lt;chr&gt;, Resultado &lt;chr&gt;, Técnica &lt;chr&gt;, …</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen Estadístico Básico</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(excel_dengue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Apellido Ciudadano Calle Domicilio    Departamento Residencia  Edad Actual    
 Length:6481        Length:6481        Length:6481             Min.   :  0.00  
 Class :character   Class :character   Class :character        1st Qu.: 21.00  
 Mode  :character   Mode  :character   Mode  :character        Median : 37.00  
                                                               Mean   : 38.29  
                                                               3rd Qu.: 55.00  
                                                               Max.   :119.00  
 Fecha Nacimiento                  Localidad Residencia Información de contacto
 Min.   :1905-07-11 00:00:00.000   Length:6481          Length:6481            
 1st Qu.:1969-06-12 00:00:00.000   Class :character     Class :character       
 Median :1987-06-08 00:00:00.000   Mode  :character     Mode  :character       
 Mean   :1985-11-19 01:50:42.308                                               
 3rd Qu.:2003-02-15 00:00:00.000                                               
 Max.   :2024-03-04 00:00:00.000                                               
 Nombre Ciudadano      Nro Doc          Numero Domicilio   Provincia Residencia
 Length:6481        Min.   :   402278   Length:6481        Length:6481         
 Class :character   1st Qu.: 20927330   Class :character   Class :character    
 Mode  :character   Median : 33214487   Mode  :character   Mode  :character    
                    Mean   : 34349629                                          
                    3rd Qu.: 44945639                                          
                    Max.   :901804363                                          
  Sexo Legal        Clasificación manual del caso Establecimiento de Carga
 Length:6481        Length:6481                   Length:6481             
 Class :character   Class :character              Class :character        
 Mode  :character   Mode  :character              Mode  :character        
                                                                          
                                                                          
                                                                          
    Evento          Fecha Apertura                  Fecha de inicio de síntomas
 Length:6481        Min.   :2024-03-01 00:00:00.0   Length:6481                
 Class :character   1st Qu.:2024-03-08 00:00:00.0   Class :character           
 Mode  :character   Median :2024-03-15 00:00:00.0   Mode  :character           
                    Mean   :2024-03-15 16:16:04.2                              
                    3rd Qu.:2024-03-22 00:00:00.0                              
                    Max.   :2024-03-31 00:00:00.0                              
 Determinación       Resultado           Técnica         
 Length:6481        Length:6481        Length:6481       
 Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character  
                                                         
                                                         
                                                         
 Fecha de toma de muestra
 Length:6481             
 Class :character        
 Mode  :character        
                         
                         
                         </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estructura de Datos</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(excel_dengue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [6,481 × 21] (S3: tbl_df/tbl/data.frame)
 $ Apellido Ciudadano           : chr [1:6481] "GARCIA GAVELLO" "SCAREL" "SEGOVIA" "ABALOS" ...
 $ Calle Domicilio              : chr [1:6481] "CEIBO" "VENDIMIADORES" "ISLAS MALVINAS" "AV. ARRIBALZAGA" ...
 $ Departamento Residencia      : chr [1:6481] "San Fernando" "Capital" "25 de Mayo" "San Fernando" ...
 $ Edad Actual                  : num [1:6481] 38 68 19 33 29 35 33 14 16 45 ...
 $ Fecha Nacimiento             : POSIXct[1:6481], format: "1986-04-17 00:00:00" "1956-05-05 00:00:00" ...
 $ Localidad Residencia         : chr [1:6481] "FONTANA" "6A. SECCION" "MACHAGAI" "RESISTENCIA" ...
 $ Información de contacto      : chr [1:6481] "; ;" "2622648747; ;" "; ;" "; ;" ...
 $ Nombre Ciudadano             : chr [1:6481] "MARIA CINTHIA YANINA" "ROQUE GERMAN" "KEVIN ARIEL" "SANTIAGO GERMAN" ...
 $ Nro Doc                      : num [1:6481] 32088648 12042164 46462652 34793111 36924972 ...
 $ Numero Domicilio             : chr [1:6481] "899" "665" "530" "1350" ...
 $ Provincia Residencia         : chr [1:6481] "Chaco" "Mendoza" "Chaco" "Chaco" ...
 $ Sexo Legal                   : chr [1:6481] "F" "M" "M" "M" ...
 $ Clasificación manual del caso: chr [1:6481] "Caso sospechoso no conclusivo" "Caso confirmado DEN-2" "Caso de Dengue en brote con laboratorio (+)" "Caso probable" ...
 $ Establecimiento de Carga     : chr [1:6481] "LABORATORIO PUEYRREDON - CENTRO DE ESTUDIOS MOLECULARES (DRA. GAZZO, ADRIANA)" "DEPARTAMENTO LABORATORIO DE SALUD PUBLICA.-" "HOSPITAL DR. ANDRES DIAZ Y PEREYRO" "LABORATORIO DE ANALISIS CLINICOS  GUEMES" ...
 $ Evento                       : chr [1:6481] "Dengue" "Dengue" "Dengue" "Dengue" ...
 $ Fecha Apertura               : POSIXct[1:6481], format: "2024-03-11" "2024-03-08" ...
 $ Fecha de inicio de síntomas  : chr [1:6481] "*sin dato*" "45352" "*sin dato*" "*sin dato*" ...
 $ Determinación                : chr [1:6481] "IgG DENV" "Antígeno NS1" "Antígeno NS1" "Antígeno NS1" ...
 $ Resultado                    : chr [1:6481] "Negativo" "Positivo" "Reactivo" "Reactivo" ...
 $ Técnica                      : chr [1:6481] "Inmunocromatografía" "Inmunocromatografía" "Inmunocromatografía" "Inmunocromatografía" ...
 $ Fecha de toma de muestra     : chr [1:6481] "45360" "45359" "45373" "45366" ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos Faltantes y No Disponibles</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(excel_dengue)) <span class="co"># Número de Datos Faltantes por Columna</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Apellido Ciudadano               Calle Domicilio 
                            0                             0 
      Departamento Residencia                   Edad Actual 
                            0                             0 
             Fecha Nacimiento          Localidad Residencia 
                            0                             0 
      Información de contacto              Nombre Ciudadano 
                            0                             0 
                      Nro Doc              Numero Domicilio 
                            0                             0 
         Provincia Residencia                    Sexo Legal 
                            0                             0 
Clasificación manual del caso      Establecimiento de Carga 
                            0                             0 
                       Evento                Fecha Apertura 
                            0                             0 
  Fecha de inicio de síntomas                 Determinación 
                            0                             0 
                    Resultado                       Técnica 
                            0                             0 
     Fecha de toma de muestra 
                            0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(excel_dengue)) <span class="co"># Número Total de Datos Faltantes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nombres de columnas </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(excel_dengue)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Apellido Ciudadano"            "Calle Domicilio"              
 [3] "Departamento Residencia"       "Edad Actual"                  
 [5] "Fecha Nacimiento"              "Localidad Residencia"         
 [7] "Información de contacto"       "Nombre Ciudadano"             
 [9] "Nro Doc"                       "Numero Domicilio"             
[11] "Provincia Residencia"          "Sexo Legal"                   
[13] "Clasificación manual del caso" "Establecimiento de Carga"     
[15] "Evento"                        "Fecha Apertura"               
[17] "Fecha de inicio de síntomas"   "Determinación"                
[19] "Resultado"                     "Técnica"                      
[21] "Fecha de toma de muestra"     </code></pre>
</div>
</div>
<p>Tambien podemos seleccionar columnas especificas y en este caso creamos una variable que contenga esta seleccion de columnas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Si antes no cargamos esta libreria lo hacemos ahora para poder utilizar las tuberias</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ahora seleccionamos las dos columnas que queremos observar</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>excel_resumido <span class="ot">&lt;-</span> excel_dengue <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(<span class="st">`</span><span class="at">Clasificación manual del caso</span><span class="st">`</span>,<span class="st">`</span><span class="at">Apellido Ciudadano</span><span class="st">`</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>excel_resumido</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6,481 × 2
   `Clasificación manual del caso`                   `Apellido Ciudadano`
   &lt;chr&gt;                                             &lt;chr&gt;               
 1 Caso sospechoso no conclusivo                     GARCIA GAVELLO      
 2 Caso confirmado DEN-2                             SCAREL              
 3 Caso de Dengue en brote con laboratorio (+)       SEGOVIA             
 4 Caso probable                                     ABALOS              
 5 Caso de Dengue en brote con laboratorio (+)       PIRIZ               
 6 Caso probable                                     BORJA BALLON        
 7 Caso confirmado por nexo epidemiológico autóctono AGUIRRE             
 8 Caso probable                                     LOVEY               
 9 Caso sospechoso                                   FERNANDEZ           
10 Caso confirmado por nexo epidemiológico autóctono OBREGON             
# ℹ 6,471 more rows</code></pre>
</div>
</div>
</section>
</section>
<section id="datos-.csv" class="level3">
<h3 class="anchored" data-anchor-id="datos-.csv">1.2. Datos .csv</h3>
<p>Importación de archivos con valores separados por comas o <strong>.csv (comma separated value).</strong></p>
<p>Vamos a crear un archivo <strong><code>.csv</code></strong> con el archivo <strong><code>Reporte dengue &amp; chiku marzo 2024.xlsx</code></strong></p>
<p>Para ello usamos la función <code>readr</code>de <code>read_csv(),</code>esta es para importar un conjunto de datos con valores delimitados por comas. Esos valores se importaron como un marco de datos y asignamos ese marco de datos al objeto R llamado <code>csv</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>csv <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"reportes/Reporte dengue &amp; chiku copia.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 6481 Columns: 21
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (19): Apellido Ciudadano, Calle Domicilio, Departamento Residencia, Fech...
dbl  (2): Edad Actual, Nro Doc

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>csv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6,481 × 21
   `Apellido Ciudadano` `Calle Domicilio`   Departamento Residen…¹ `Edad Actual`
   &lt;chr&gt;                &lt;chr&gt;               &lt;chr&gt;                          &lt;dbl&gt;
 1 GARCIA GAVELLO       CEIBO               San Fernando                      38
 2 SCAREL               VENDIMIADORES       Capital                           68
 3 SEGOVIA              ISLAS MALVINAS      25 de Mayo                        19
 4 ABALOS               AV. ARRIBALZAGA     San Fernando                      33
 5 PIRIZ                LOTE                Mayor Luis J. Fontana             29
 6 BORJA BALLON         PASAJE INGENIERO F… San Fernando                      35
 7 AGUIRRE              PLANTA URBANA       General Güemes                    33
 8 LOVEY                LAS TRES BOCAS      San Fernando                      14
 9 FERNANDEZ            BARRIO MATADERO     Sargento Cabral                   16
10 OBREGON              BONEO               General Güemes                    45
# ℹ 6,471 more rows
# ℹ abbreviated name: ¹​`Departamento Residencia`
# ℹ 17 more variables: `Fecha Nacimiento` &lt;chr&gt;, `Localidad Residencia` &lt;chr&gt;,
#   `Información de contacto` &lt;chr&gt;, `Nombre Ciudadano` &lt;chr&gt;, `Nro Doc` &lt;dbl&gt;,
#   `Numero Domicilio` &lt;chr&gt;, `Provincia Residencia` &lt;chr&gt;, `Sexo Legal` &lt;chr&gt;,
#   `Clasificación manual del caso` &lt;chr&gt;, `Establecimiento de Carga` &lt;chr&gt;,
#   Evento &lt;chr&gt;, `Fecha Apertura` &lt;chr&gt;, …</code></pre>
</div>
</div>
</section>
<section id="google-sheet" class="level3">
<h3 class="anchored" data-anchor-id="google-sheet">1.3. Google sheet</h3>
<p>Para cargar una tabla que tenemos en google drive debemos importarla desde el paquete <code>googlesheet4</code></p>
<p><a href="https://googlesheets4.tidyverse.org/" class="uri">https://googlesheets4.tidyverse.org/</a></p>
<p>Para ello primero instalamos el paquete necesario. Además necesitaremos utilizar para la autenticación el paquete <code>httpuv</code>, ya que es necesario que la cuenta que utlicemos de google se concete con R para realizar la transferencia de datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># El segundo paquete es necesario para uno de los pasos de la autenticación</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("googlesheets4")</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("httpuv")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(googlesheets4)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httpuv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>El <code>"gs4_auth()"</code> abrira una ventana emergente que nos pedirá permiso para conectarse a nuestra cuenta google. Una vez aceptado esto se procede a importar los datos del drive.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># gs4_auth()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Podemos vincular nuestra cuenta de mail para que no tengamos que aptar cada vez que corramos nuestro chunk con un <strong>código Token, como una forma de automatizar el proceso.</strong> Luego simplemente corremos el código y activamos nuestro vinculo con google drive.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(googlesheets4)</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Esto abre una ventana en el navegador para autenticar tu cuenta de Google</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co"># gs4_auth(cache = ".secrets", email = "mail")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Luego solo ejecuto esta linea y se concetará:</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># gs4_auth(cache = ".secrets", email = "mflorenciamena@gmail.com")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Luego de esto obtenemos el link de nuestro archivo. Usamos la función <code>read_sheet()</code> para leer los datos de una hoja de cálculo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Leer el archivo de Google Sheets usando su ID</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Reemplaza 'FILE_ID' con el ID del archivo real</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># sheet_url &lt;- "https://docs.google.com/spreadsheets/d/FILE_ID/edit"</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># dengue_sheet &lt;- read_sheet("https://docs.google.com/spreadsheets/d/10tk_qJ3yinCGwLhrdSpZYi9UromLl21edS4mxcnCQno/edit")</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Leer una hoja específica por nombre </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co"># En este ejemplo tendriamos que modificar el contido del código con uno real</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># datos &lt;- read_sheet(sheet_url, sheet = "NombreDeLaHoja")</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Leer una hoja específica por índice</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># datos &lt;- read_sheet(sheet_url, sheet = 1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="herramienta-de-importación-de-datos-de-rstudio" class="level3">
<h3 class="anchored" data-anchor-id="herramienta-de-importación-de-datos-de-rstudio">1.4. Herramienta de importación de datos de RStudio</h3>
<p>Para abrir la herramienta de importación de datos de RStudio, haga clic en el Import Dataset &gt;menú desplegable cerca de la parte superior del panel del entorno. Se elige el tipo de archivo que se quiere importar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>Reporte_infecciones_respiratorias_marzo_2024 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"reportes/Reporte infecciones respiratorias marzo 2024.xlsx"</span>, </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">na =</span> <span class="fu">c</span>(<span class="st">"*sin dato*"</span>, <span class="st">"SIN DATO"</span>, <span class="st">" "</span>))</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(Reporte_infecciones_respiratorias_marzo_2024)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="limpieza-de-datos" class="level1">
<h1><strong>2. Limpieza de Datos</strong></h1>
<p>&nbsp;</p>
<section id="identificación-de-datos-faltantes" class="level2">
<h2 class="anchored" data-anchor-id="identificación-de-datos-faltantes">2.1. Identificación de datos faltantes</h2>
<section id="archivo-.xlsx" class="level3">
<h3 class="anchored" data-anchor-id="archivo-.xlsx">2.1.1. Archivo .xlsx</h3>
<p>Para comenzar la limpieza de datos en primer lugar debemos ver si existen datos faltantes, y en este caso escribir un código que permita reemplazar la nomenclatura que trae por <code>NA</code> que es como R lee los datos faltantes.</p>
<p>Esto puede realizarse cuando importamos el dataset o podemos hacerlo una vez que lo tenemos importado. Vemos las dos formas.</p>
<p><strong>Primera forma (es mucho más simple)</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Establecer el na argumento para datos faltantes</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>dengue_na <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"reportes/Reporte dengue &amp; chiku marzo 2024.xlsx"</span>, <span class="at">na =</span> <span class="fu">c</span>(<span class="st">"."</span>, <span class="st">"perdido"</span>, <span class="st">"*sin dato*"</span>, <span class="st">"; ;"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Segunda forma (lleva más cantidad de pasos)</strong></p>
<p>Otra forma de realizarlo es una vez que tenemos el dataset incorporado realizarlo con la funcion <code>mutate()</code> del paquete <code>dplyr</code></p>
<div style="background-color:  #FFFFCC; padding: 20px; border: 1px solid #ccc; border-radius: 5px">
<p><strong>Importante:</strong> Hay que tener en cuenta que para modificar la estructura de datos faltantes a <code>NA</code> va a depender de la estructura de datos que tengamos, por ejemplo si es son de caracter, numérica o de fecha. Como los datos con los que contamos tienen fechas y la inscripción “<em>sin datos</em>” en la misma columna, R lee esta estructura como carcater (ya que <strong>no pueden contener estructuras de datos distintas</strong>). Por lo que en este caso nos conviene pirmero modificar los datos a <code>NA</code> y luego modificar la estructura de datos a fechas.</p>
</div>
<p>En este ejemplo veremos de cambiar en primer lugar todas las columnas de caracter con el NA, y para ello tendremos que modificar la estructura de los datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paso 1: Reemplazar valores específicos con NA en columnas de carácter</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>dengue_na2 <span class="ot">&lt;-</span> excel_dengue <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), <span class="sc">~</span> <span class="fu">na_if</span>(.x, <span class="st">"*sin dato*"</span>))) <span class="sc">%&gt;%</span>  </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), <span class="sc">~</span> <span class="fu">na_if</span>(.x, <span class="st">""</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"Fecha de toma de muestra"</span>, <span class="st">"Fecha de inicio de síntomas"</span>, <span class="st">"Fecha Apertura"</span>, <span class="st">"Fecha Nacimiento"</span>),</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                <span class="sc">~</span> <span class="fu">as.Date</span>(<span class="fu">as.numeric</span>(.), <span class="at">origin =</span> <span class="st">"1899-12-30"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Esto es lo que hicimos arriba:</strong></p>
<p>El símbolo <code>~</code> en R es utilizado en varias funciones para representar <strong>“una fórmula”</strong> o <strong>“una función”</strong>. En el caso del código anterior, el símbolo <code>~</code> se usa para definir una <strong>función</strong> dentro de <code>mutate()</code> y <code>across()</code>.</p>
<p>Cuando usamos <code>across()</code> con <code>mutate()</code>, estamos diciendo que queremos aplicar una función a todas las columnas del dataset. En lugar de escribir una función con nombre por separado, se usa el símbolo <code>~</code> para definir una <strong>función</strong> de manera rápida.</p>
<p>Aquí, <code>~</code> indica que lo que sigue es una función, donde <code>.x</code> es un carcater que representa los valores de cada columna a los que se va a aplicar la función <code>na_if()</code>. En este caso, estamos diciendo:</p>
<p><em>“Para cada valor en las columnas, reemplaza <code>sin datos</code> por <code>NA</code>.”</em></p>
<p>Es una forma abreviada de escribir una función que podríamos definir así:</p>
<p><code>function(x) na_if(x, "sin datos")</code></p>
<p><strong>Reemplazo en Columnas de Carácter</strong> <strong>*sin dato* a na:</strong></p>
<ul>
<li><p><strong><code>na_if(.x, "sin dato")</code></strong>: Reemplaza <code>"sin dato"</code> con <code>NA</code> en columnas de carácter.</p></li>
<li><p><strong><code>na_if(.x, "")</code></strong>: Reemplaza espacios en blanco con <code>NA</code> en columnas de carácter.</p></li>
<li><p><strong><code>.x</code></strong> Es un marcador de posición para la columna actual que está siendo manipulada por across().</p></li>
<li><p><strong><code>across(c(...), ~ as.Date(...))</code></strong>: Después de limpiar los datos, convierte las columnas de fecha que se especifican a formato <code>Date</code>.</p></li>
<li><p><strong><code>as.numeric(.)</code></strong>: Convierte el carácter a número (en caso de que los valores sean importados como texto).</p></li>
<li><p><strong><code>as.Date(as.numeric(.), origin = "1899-12-30")</code></strong>: Convierte los números de serie de Excel a fechas reales.</p></li>
</ul>
</section>
<section id="archivo-sheet" class="level3">
<h3 class="anchored" data-anchor-id="archivo-sheet">2.1.2. Archivo sheet</h3>
<p>Cuando intentamos realizar lo mismo con el dataset de google sheet es necesario primero ver que estructura de datos tengo en este data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(dengue_sheet, class)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Aquí, <code>sapply</code> está aplicando la función <code>class</code> a cada columna del dataframe <code>dengue_na2</code>. El resultado es un vector que contiene la clase de cada columna en el dataframe. Esto te permite ver rápidamente qué tipo de datos hay en cada columna.</p>
<p>Como vemos las fechas de “Fecha de toma de muestra” y “Fecha de inicio de síntomas” se importaron como “list”, por lo tanto no me convertira los datos si no los transformo a “carcater”. Entonces antes que nada realizamos esta tarea:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dengue_sheet_paso &lt;- dengue_sheet %&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">#      mutate(across(where(is.list), ~ map_chr(.x, ~ paste(as.character(.), collapse = ", "))))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Esto hicimos arriba:</strong></p>
<p><em>La biblioteca <code>purrr</code> es parte del “tidyverse” en R y proporciona una serie de funciones para trabajar con listas</em></p>
<ul>
<li><p><strong><code>mutate()</code></strong>:</p>
<ul>
<li><p>Esta función de <code>dplyr</code> se utiliza para modificar o añadir columnas en un dataframe.</p></li>
<li><p>En este caso, estamos modificando las columnas existentes.</p></li>
</ul></li>
<li><p><strong><code>across(where(is.list), ...)</code></strong>:</p>
<ul>
<li><p><strong><code>across()</code></strong>: Permite aplicar una función a un conjunto de columnas seleccionadas en el dataframe.</p></li>
<li><p><strong><code>where(is.list)</code></strong>: Especifica las columnas en las que queremos aplicar la función. En este caso, selecciona solo las columnas que son listas (<code>is.list</code>).</p></li>
</ul></li>
<li><p><strong><code>~ map_chr(.x, ~ paste(as.character(.), collapse = ", "))</code></strong>:</p>
<ul>
<li><p><strong><code>~</code></strong>: Introduce una fórmula anónima (lambda) para aplicar a cada columna seleccionada.</p></li>
<li><p><strong><code>.x</code></strong>: Representa la columna actual en la que estamos trabajando dentro de <code>across()</code>.</p></li>
<li><p><strong><code>map_chr(.x, ...)</code></strong>: Usa la función <code>map_chr</code> del paquete <code>purrr</code> para aplicar una función a cada elemento de la columna. <code>map_chr</code> convierte el resultado en un vector de caracteres.</p>
<ul>
<li><p><strong><code>map_chr(.x, ~ paste(as.character(.), collapse = ", "))</code></strong>: Aplica una función a cada elemento en la columna de listas.</p>
<ul>
<li><p><strong><code>as.character(.)</code></strong>: Convierte cada elemento de la lista en un carácter.</p></li>
<li><p><strong><code>paste(..., collapse = ", ")</code></strong>: Une los elementos convertidos a caracteres en una sola cadena de texto, separada por comas. Aquí, <code>paste()</code> combina todos los elementos en un solo string, y <code>collapse = ", "</code> especifica que los elementos deben estar separados por comas y espacios.</p></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<p>Verificamos que se realizó:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sapply(dengue_sheet_paso, class)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Y ahora pasamos al reemplazo por <code>NA</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sheet_na &lt;- dengue_sheet_paso %&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(across(where(is.character), ~ na_if(.x, "*sin dato*"))) %&gt;%  # Reemplaza "sin dato" con NA</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   mutate(across(where(is.character), ~ na_if(.x, "")))  # Reemplaza espacios en blanco con NA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="convertir-variables-a-tipos-correctos" class="level2">
<h2 class="anchored" data-anchor-id="convertir-variables-a-tipos-correctos">2.2. Convertir variables a tipos correctos</h2>
<p>Como vimos anteriormente comprender la estructura de datos que tienen nuestros dataset es muy importante para poder manipularlos y administarlos. Por ello vamos a ver como trabajar específicamente con fechas y factores.</p>
<section id="fechas" class="level3">
<h3 class="anchored" data-anchor-id="fechas">2.2.1. Fechas</h3>
<p>En R, hay dos tipos de vectores diferentes que podemos usar para almacenar y trabajar con fechas:</p>
<ul>
<li><p><strong><code>date</code></strong> vectores para trabajar con valores de fecha, ejemplo: <code>2009-01-08</code>.</p></li>
<li><p>Vectores <strong><code>POSIXct</code></strong>para trabajar con valores de fecha y hora, ejemplo: <code>2009-01-08 20:00:00</code>.</p></li>
</ul>
<p><strong>En general, es recomendable trabajar con valores de fecha</strong>, en lugar de valores de fecha y hora, siempre que sea posible.</p>
<p><strong>Revisión de datos</strong></p>
<p>Si vieron en los dataset importados las columnas de “Fecha de toma de muestra” y “Fecha de inicio de síntoma” se importaron con una estructura de caracter (ya que la información “sin dato” conviertio hizo que R leyera como caracter toda la columna).</p>
<ul>
<li><p><strong>Como Excel guarda las fechas</strong>: Cuando importamos datos de Excel a R y las fechas están en formato de texto con valores como “sin datos”, R puede interpretar esas fechas como números, especialmente si Excel las guarda como números seriales (que es un formato común para fechas en Excel). El número que aperece con este corresponde a la cantidad de días transcurridos desde el 1 <strong>de enero de 1900 (formato predeterminado de Excel para las fechas).</strong></p>
<p>Para convertir estos números de serie de Excel a fechas en R, se puede utilizar <code>as.Date()</code> con la opción <code>origin = "1899-12-30".</code> Este “origen” se debe a que Excel considera el día 1 como el 1 de enero de 1900, pero hay un ajuste de 1 día debido a un error histórico en Excel.</p></li>
<li><p><strong>Como R guarda las fechas</strong>: R almacena las fechas como números. En concreto, la cantidad de días antes o después del 1 de enero de 1970 a las 00:00:00 UTC.</p></li>
</ul>
<p>Esto es simplemente por si aparecen números que no comprendemos de donde vienen en las columnas fechas. Pero los vamos a trabajar de la misma manera:</p>
<p>Utilizar la funcion <code>mutate()</code> para modificar las columnas necesarias a fechas con <code>as.Date</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>dengue_limpio <span class="ot">&lt;-</span> dengue_na <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"Fecha de toma de muestra"</span>, <span class="st">"Fecha de inicio de síntomas"</span>, <span class="st">"Fecha Apertura"</span>, <span class="st">"Fecha Nacimiento"</span>), as.Date))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dengue_limpio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [6,481 × 21] (S3: tbl_df/tbl/data.frame)
 $ Apellido Ciudadano           : chr [1:6481] "GARCIA GAVELLO" "SCAREL" "SEGOVIA" "ABALOS" ...
 $ Calle Domicilio              : chr [1:6481] "CEIBO" "VENDIMIADORES" "ISLAS MALVINAS" "AV. ARRIBALZAGA" ...
 $ Departamento Residencia      : chr [1:6481] "San Fernando" "Capital" "25 de Mayo" "San Fernando" ...
 $ Edad Actual                  : num [1:6481] 38 68 19 33 29 35 33 14 16 45 ...
 $ Fecha Nacimiento             : Date[1:6481], format: "1986-04-17" "1956-05-05" ...
 $ Localidad Residencia         : chr [1:6481] "FONTANA" "6A. SECCION" "MACHAGAI" "RESISTENCIA" ...
 $ Información de contacto      : chr [1:6481] NA "2622648747; ;" NA NA ...
 $ Nombre Ciudadano             : chr [1:6481] "MARIA CINTHIA YANINA" "ROQUE GERMAN" "KEVIN ARIEL" "SANTIAGO GERMAN" ...
 $ Nro Doc                      : num [1:6481] 32088648 12042164 46462652 34793111 36924972 ...
 $ Numero Domicilio             : chr [1:6481] "899" "665" "530" "1350" ...
 $ Provincia Residencia         : chr [1:6481] "Chaco" "Mendoza" "Chaco" "Chaco" ...
 $ Sexo Legal                   : chr [1:6481] "F" "M" "M" "M" ...
 $ Clasificación manual del caso: chr [1:6481] "Caso sospechoso no conclusivo" "Caso confirmado DEN-2" "Caso de Dengue en brote con laboratorio (+)" "Caso probable" ...
 $ Establecimiento de Carga     : chr [1:6481] "LABORATORIO PUEYRREDON - CENTRO DE ESTUDIOS MOLECULARES (DRA. GAZZO, ADRIANA)" "DEPARTAMENTO LABORATORIO DE SALUD PUBLICA.-" "HOSPITAL DR. ANDRES DIAZ Y PEREYRO" "LABORATORIO DE ANALISIS CLINICOS  GUEMES" ...
 $ Evento                       : chr [1:6481] "Dengue" "Dengue" "Dengue" "Dengue" ...
 $ Fecha Apertura               : Date[1:6481], format: "2024-03-11" "2024-03-08" ...
 $ Fecha de inicio de síntomas  : Date[1:6481], format: NA "2024-03-01" ...
 $ Determinación                : chr [1:6481] "IgG DENV" "Antígeno NS1" "Antígeno NS1" "Antígeno NS1" ...
 $ Resultado                    : chr [1:6481] "Negativo" "Positivo" "Reactivo" "Reactivo" ...
 $ Técnica                      : chr [1:6481] "Inmunocromatografía" "Inmunocromatografía" "Inmunocromatografía" "Inmunocromatografía" ...
 $ Fecha de toma de muestra     : Date[1:6481], format: "2024-03-09" "2024-03-08" ...</code></pre>
</div>
</div>
<p><strong>Tambien podemos usar este código con mutate() en caso que tengamos los numeros coidficados por excel, debemos poner la fecha de inicio de excel</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Este no va a funcionar, porque solo sirve para planillas de excel que estan codificadas por este:</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a> <span class="co"># data$`Fecha de toma de muestra` &lt;- as.Date(data$`Fecha de toma de muestra`, origin = "1899-12-30")</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a> <span class="co"># Convertir las fechas de Excel/ depende si ya lo hicimos antes</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Comprobamos que se realizó la modificación</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(dengue_limpio, class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="opcional" class="level4">
<h4 class="anchored" data-anchor-id="opcional">Opcional</h4>
<p>Tambien puedo querer <strong>cambiar el formato de fecha</strong> con el que aparece alguna columna (a modo de ejemplo):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>dengue_date <span class="ot">&lt;-</span> dengue_na <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Fecha de toma de muestra</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">format</span>(<span class="st">`</span><span class="at">Fecha de toma de muestra</span><span class="st">`</span>, <span class="st">"%d %b %y"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Algunas fechas incorporadas en R</strong></p>
<p>Fecha de hoy y meses</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.Date</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2024-09-16"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>month.name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "January"   "February"  "March"     "April"     "May"       "June"     
 [7] "July"      "August"    "September" "October"   "November"  "December" </code></pre>
</div>
</div>
</section>
</section>
<section id="crear-semanas-epidemiológicas" class="level3">
<h3 class="anchored" data-anchor-id="crear-semanas-epidemiológicas">2.2.1.1 Crear semanas epidemiológicas</h3>
<p>Para ello vamos a utilizar el paquete lubridate. Este paquete entre otras cosas permite:</p>
<ul>
<li><p><strong>Conversión de fechas:</strong> Convierte cadenas de texto en objetos de fecha y hora de manera fácil y flexible, adaptándose a diferentes formatos.</p></li>
<li><p><strong>Extracción de componentes:</strong> Permite extraer partes específicas de una fecha y hora, como el año, mes, día, hora, minuto, segundo, etc.</p></li>
<li><p><strong>Cálculos con fechas:</strong> Realiza operaciones aritméticas con fechas, como calcular la diferencia entre dos fechas, sumar o restar días, meses o años.</p></li>
<li><p><strong>Manipulación de zonas horarias:</strong> Te ayuda a trabajar con diferentes zonas horarias y realizar conversiones entre ellas.</p></li>
<li><p><strong>Creación de intervalos de tiempo:</strong> Define y manipula intervalos de tiempo, como períodos de un día, una semana o un mes.</p></li>
</ul>
<section id="crear-semanas-epidemiológicas-anual" class="level4">
<h4 class="anchored" data-anchor-id="crear-semanas-epidemiológicas-anual">Crear semanas epidemiológicas anual</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ejemplo para ver que puedo consultar por fecha</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>fecha <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">"2024-01-15"</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>epi_week <span class="ot">&lt;-</span> <span class="fu">epiweek</span>(fecha)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular semana epidemiologica con la función epiweek</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>dengue_semana_epi <span class="ot">&lt;-</span> dengue_limpio <span class="sc">%&gt;%</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">semana_epi =</span> <span class="fu">epiweek</span>(<span class="st">`</span><span class="at">Fecha de toma de muestra</span><span class="st">`</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p><strong>Ejemplo más desarrollado OPCIONAL:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir el año epidemiológico que no cambiará</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>anio_epidemiologico <span class="ot">&lt;-</span> <span class="dv">2024</span>  <span class="co"># Año fijo para los reportes</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir el inicio del año y calcular el primer domingo del año epidemiológico</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>inicio_anual <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(anio_epidemiologico <span class="sc">-</span><span class="dv">1</span>, <span class="st">"-12-31"</span>))</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>primer_domingo <span class="ot">&lt;-</span> <span class="fu">floor_date</span>(inicio_anual, <span class="at">unit =</span> <span class="st">"week"</span>, <span class="at">week_start =</span> <span class="dv">7</span>)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear una nueva columna 'semana_epi' calculando la semana epidemiológica</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>dengue_semana_epi <span class="ot">&lt;-</span> dengue_limpio <span class="sc">%&gt;%</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Fecha de toma de muestra</span><span class="st">`</span> <span class="sc">&gt;=</span> primer_domingo) <span class="sc">%&gt;%</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">semana_epi =</span> <span class="fu">as.integer</span>((<span class="fu">as.numeric</span>(<span class="st">`</span><span class="at">Fecha de toma de muestra</span><span class="st">`</span> <span class="sc">-</span> primer_domingo) <span class="sc">/</span> <span class="dv">7</span>)) <span class="sc">+</span> <span class="dv">1</span>  <span class="co"># Calcular la semana epidemiológica</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Esto hicimos arriba:</strong></p>
<ul>
<li><p><strong><code>anio_epidemiologico &lt;- 2024</code></strong>: Define el año para el cual se están calculando las semanas epidemiológicas. En este caso, es el año 2024.</p></li>
<li><p><strong><code>paste0(anio_epidemiologico, "-01-01")</code></strong>: Crea una cadena de texto que representa el primer día del año en formato <code>"YYYY-MM-DD"</code>. Por ejemplo, <code>"2024-01-01"</code>.</p></li>
<li><p><strong><code>as.Date(...)</code></strong>: Convierte esa cadena en un objeto de tipo <code>Date</code> en R.</p></li>
<li><p><strong><code>floor_date(inicio_anual, unit = "week", week_start = 1)</code></strong>: Calcula el primer lunes del año. La función <code>floor_date()</code> ajusta la fecha hacia abajo al inicio de la unidad de tiempo especificada. Aquí se especifica <code>unit = "week"</code> y <code>week_start = 1</code> para encontrar el lunes de la semana que contiene el primer día del año (<code>inicio_anual</code>).</p>
<p><strong>Parámetros de <code>floor_date</code></strong>:</p>
<ul>
<li><p><strong><code>unit = "week"</code></strong>: Especifica que queremos redondear al inicio de la semana. <code>unit</code> puede ser <code>"second"</code>, <code>"minute"</code>, <code>"hour"</code>, <code>"day"</code>, <code>"week"</code>, <code>"month"</code>, <code>"quarter"</code>, o <code>"year"</code>. En este caso, estamos redondeando a la semana.</p></li>
<li><p><strong><code>week_start = 1</code></strong>: Define que la semana comienza en el lunes. En el sistema ISO, la semana generalmente empieza en lunes (<code>week_start = 1</code>). Puedes ajustar este valor a <code>0</code> para que la semana comience en domingo.</p></li>
</ul></li>
<li><p><strong><code>mutate(...)</code></strong>: Agrega o modifica columnas en el dataframe <code>dengue_na</code>.</p></li>
<li><p><strong><code>fecha = as.Date(</code></strong><em>Fecha de toma de muestra</em><strong><code>, origin = "1899-12-30")</code></strong>:</p>
<ul>
<li>Convierte la columna <code>Fecha de toma de muestra</code> de Excel a un objeto <code>Date</code> en R. Excel usa <code>1899-12-30</code> como origen para fechas numéricas, por lo que esta línea convierte la fecha numérica a formato de fecha.</li>
</ul></li>
<li><p><strong><code>semana_epi = as.integer((as.numeric(fecha - primer_lunes) / 7)) + 1</code></strong>:</p>
<ul>
<li><p><strong><code>fecha - primer_lunes</code></strong>: Calcula la diferencia en días entre la fecha de muestra y el primer lunes del año.</p></li>
<li><p><strong><code>as.numeric(...)</code></strong>: Convierte la diferencia de fechas en un número de días. Esto es necesario porque la diferencia entre fechas en R se calcula como un objeto de tipo <code>difftime</code>, y necesitamos convertirlo a un número para realizar cálculos matemáticos.</p></li>
<li><p><strong><code>/ 7</code></strong>: Convierte los días en semanas (dividiendo por 7).</p></li>
<li><p><strong><code>as.integer(...)</code></strong>: Convierte el resultado en un número entero, ya que las semanas deben ser enteros.</p></li>
<li><p><strong><code>+ 1</code></strong>: Ajusta el cálculo para que la semana epidemiológica comience en 1 en lugar de 0.</p></li>
</ul></li>
<li><p><strong><code>filter(`Fecha de toma de muestra` &gt;= primer_lunes) %&gt;%</code></strong> Filtrar fechas anteriores, Si no necesitas los datos con fechas anteriores al primer lunes del año epidemiológico</p></li>
</ul>
<hr>
<p>Ahora con esto listo podríamos contar la cantidad de casos por semana epidemiológica por ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contar casos por semana epidemiológica</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>casos_por_semana <span class="ot">&lt;-</span> dengue_semana_epi <span class="sc">%&gt;%</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(semana_epi) <span class="sc">%&gt;%</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">casos =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>casos_por_semana</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 2
   semana_epi casos
        &lt;dbl&gt; &lt;int&gt;
 1          2    23
 2          3    10
 3          4     4
 4          5    32
 5          6    90
 6          7    18
 7          8    77
 8          9   434
 9         10  1047
10         11  1110
11         12  1192
12         13   787
13         14    27
14         20     3</code></pre>
</div>
</div>
<p><strong>Esto hicimos arriba:</strong></p>
<ul>
<li><p><strong><code>group_by(semana_epi)</code></strong>:</p>
<ul>
<li><p>Agrupa los datos del <code>dataframe</code> por la columna <code>semana_epi</code> (la columna que representa las semanas epidemiológicas).</p></li>
<li><p>Esto crea subconjuntos de los datos que corresponden a cada semana epidemiológica, lo cual permite calcular estadísticas dentro de cada grupo (en este caso, contar el número de casos).</p></li>
</ul></li>
<li><p><strong><code>summarise(casos = n())</code></strong>:</p>
<ul>
<li><p><code>summarise()</code> se usa para calcular resúmenes dentro de cada grupo.</p></li>
<li><p>En este caso, <code>casos = n()</code> cuenta el número de filas (observaciones) dentro de cada grupo de <code>semana_epi</code>. Este número de filas representa el número de casos de dengue en cada semana epidemiológica.</p></li>
</ul></li>
<li><p><strong><code>.groups = 'drop'</code></strong>:</p>
<ul>
<li><p>Este argumento controla cómo se manejan los grupos después de que se aplica el <code>summarise()</code>.</p></li>
<li><p>En este caso, <code>.groups = 'drop'</code> indica que, después de hacer la agrupación y el resumen, se “descarten” (eliminen) los grupos.+</p></li>
<li><p>En otras palabras, se quita la información de agrupamiento después del cálculo. Si no se especificara <code>drop</code>, el dataframe resultante seguiría teniendo la agrupación por <code>semana_epi</code>, lo que podría afectar operaciones futuras.</p></li>
<li><p>Usar <code>drop</code> es útil para asegurarse de que el resultado es un dataframe simple, sin rastros de la agrupación.</p></li>
<li></li>
</ul></li>
</ul>
<div style="background-color:  #F4A4A4; padding: 20px; border: 1px solid #ccc; border-radius: 5px">
<p>Antes de guardar y cerrar nuestro archivo es necesario que guardemos nuestro nuevo marcos de datos con el que estuvimos trabajando para que no se pierdan los procesos anteriores con la función <code>write_xlsx()</code></p>
</div>
</section>
</section>
</section>
<section id="guardar-el-dataframe" class="level2">
<h2 class="anchored" data-anchor-id="guardar-el-dataframe">Guardar el DataFrame</h2>
<p>Guardar los datos en formato <code>.xlsx</code> es una buena opción si lo que se busca es preservar la estructura de datos después de la limpieza y no además no queremos que repetir el proceso en un nuevo proyecto. Se puede guardar un dataframe en un archivo <code>.xlsx</code> usando el paquete <code>writexl.</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("writexl")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(writexl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardar y especificar el nuevo nombre de archivo</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(dengue_limpio, <span class="at">path =</span> <span class="st">"dengue_limpio.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ahora podemos comprobar en que directorio estamos trabajando con este comando:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quitar el numeral para correr el código</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co"># getwd()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Si queremos establecer un nuevo directorio:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Establecer un nuevo directorio de trabajo</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("ruta/al/nuevo/directorio")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Tambien se puede guardar directamente en una ruta específica:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Guardar en una ruta específica</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_xlsx</span>(dengue_semana_epi, <span class="at">path =</span> <span class="st">"C:/Users/flor/Desktop/cursor_2024/VigilanciaenR/dengue_limpio.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<script src="Clase_2_files/libs/quarto-html/zenscroll-min.js"></script>
</body></html>